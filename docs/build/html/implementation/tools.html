
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>tools Package &#8212; TigerShark 3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The TODO List" href="../todo.html" />
    <link rel="prev" title="X12 Package" href="x12.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-tools">
<span id="tools-package"></span><h1><code class="docutils literal notranslate"><span class="pre">tools</span></code> Package<a class="headerlink" href="#module-tools" title="Permalink to this heading">¶</a></h1>
<section id="tools">
<h2>Tools<a class="headerlink" href="#tools" title="Permalink to this heading">¶</a></h2>
<p>The tools are used to create Python and JSON Schema definitions.</p>
<section id="module-tools.xml_extract">
<span id="tools-xml-extract"></span><h3>tools.xml_extract<a class="headerlink" href="#module-tools.xml_extract" title="Permalink to this heading">¶</a></h3>
<p>Read the schema from the PYx12 project’s XML-based schema definitions.</p>
<p>See <a class="reference external" href="https://github.com/azoner/pyx12">https://github.com/azoner/pyx12</a></p>
<p>See <a class="reference external" href="https://github.com/azoner/pyx12/tree/master/pyx12/map">https://github.com/azoner/pyx12/tree/master/pyx12/map</a> for the message definitions.</p>
<p>This application extracts the Element, Composite, Segment, Loop, and Message schemas from these definitions.</p>
<p>The idea is to create two useful documents:</p>
<ul class="simple">
<li><p>A JSONSchema definition as a common structure to describe the EDI messages.</p></li>
<li><p>This package’s X12 modules with class definitions for each message based on an <code class="docutils literal notranslate"><span class="pre">x12.base</span></code> module’s
parent classes.</p></li>
</ul>
<section id="source">
<h4>Source<a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h4>
<p>Several sources of data are integrated to create the full schema.</p>
<ol class="arabic simple">
<li><p>The nnn.nnnn.xnnnn…xml files. Example 270.4010.X092.A1.xml. These have the message definitions.</p></li>
<li><p>The codes.xml, detaele.xml with additional data to support the data type definitions.</p></li>
<li><p>The x12.control.00401.xml and x12.control.00501.xml with core structural information
used to map a message to the specific message definition.</p></li>
</ol>
<p>It’s not perfectly clear that maps.xml is <em>required</em>, but it seems useful for creating
a declarative set of X12 messages.</p>
<p>The complication here is that within a given message definition,
the Element, Segment, Loop, Message structure is unique, but the names are reused.
This means the message – as a whole – is a kind of namespace around the structural elements.</p>
<p>The class definitions here are <em>only</em> used to extract the XML-based schema information.
They’re not related in any way to processing X12 EDI messages.</p>
</section>
<section id="x12-schema">
<h4>X12 Schema<a class="headerlink" href="#x12-schema" title="Permalink to this heading">¶</a></h4>
<p>The X12 schema definitions created here depend on an <code class="docutils literal notranslate"><span class="pre">x12.base</span></code> module to provide
the superclass definitions of Element, Composite, Segment, Loop, and Message.</p>
<p>This app writes a collection of message-specific modules
with subclass definitions for all of the elements, etc., that are part of that message.
Reuse is not considered at this point.
In many cases, the Control segments (ISA, IEA, GS, GE, etc.) are reusable,
and should not be repeated in each module.</p>
</section>
<section id="structure-and-naming">
<h4>Structure and Naming<a class="headerlink" href="#structure-and-naming" title="Permalink to this heading">¶</a></h4>
<p>Names of Segments and Elements are reused extensively.
The Loop is the context in which Segment, Composite, and Element names are understood.</p>
<p>The idea of exposing the Segments as if they are dataclass-like records
is made challenging by way Segments are reused in distinct Loops.</p>
<p>The overall “mapping” from source text to message is a separate capability
This uses generic x12.control.* module generic definitions to locate the correct module to process a message.</p>
</section>
<section id="type-definitions">
<h4>Type Definitions<a class="headerlink" href="#type-definitions" title="Permalink to this heading">¶</a></h4>
<p>The Data Element definitions, used to create Elements, are heavily reused.
These become a module of Schema details used to build the final schema
for a given Element.</p>
<p>The Data Type attribute is – apparently – the base
Python type, only.</p>
<p>There are 3 variations on DT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;data_ele</span> <span class="pre">ele_num=&quot;I08&quot;</span> <span class="pre">data_type=&quot;DT&quot;</span> <span class="pre">min_len=&quot;6&quot;</span> <span class="pre">max_len=&quot;6&quot;</span> <span class="pre">name=&quot;I08&quot;/&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;data_ele</span> <span class="pre">ele_num=&quot;373&quot;</span> <span class="pre">data_type=&quot;DT&quot;</span> <span class="pre">min_len=&quot;8&quot;</span> <span class="pre">max_len=&quot;8&quot;</span> <span class="pre">name=&quot;Date&quot;/&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;data_ele</span> <span class="pre">ele_num=&quot;29&quot;</span> <span class="pre">data_type=&quot;DT&quot;</span> <span class="pre">min_len=&quot;6&quot;</span> <span class="pre">max_len=&quot;8&quot;</span> <span class="pre">name=&quot;Date&quot;/&gt;</span></code></p></li>
</ul>
<p>This means there are three underlying data element definitions</p>
<dl class="field-list simple">
<dt class="field-odd">I08<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">{&quot;type&quot;:</span> <span class="pre">&quot;string&quot;,</span> <span class="pre">&quot;minLength&quot;:</span> <span class="pre">6,</span> <span class="pre">&quot;maxLength&quot;:</span> <span class="pre">6,</span> <span class="pre">&quot;format&quot;:</span> <span class="pre">&quot;\d{6}&quot;,</span> <span class="pre">&quot;x-datetime&quot;:</span> <span class="pre">&quot;%y%m%d&quot;}</span></code></p>
</dd>
<dt class="field-even">D373<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">{&quot;type&quot;:</span> <span class="pre">&quot;string&quot;,</span> <span class="pre">&quot;minLength&quot;:</span> <span class="pre">8,</span> <span class="pre">&quot;maxLength&quot;:</span> <span class="pre">8,</span> <span class="pre">&quot;format&quot;:</span> <span class="pre">&quot;\d{8}&quot;,</span> <span class="pre">&quot;x-datetime&quot;:</span> <span class="pre">&quot;%Y%m%d&quot;}</span></code></p>
</dd>
<dt class="field-odd">D29<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">{&quot;type&quot;:</span> <span class="pre">&quot;string&quot;,</span> <span class="pre">&quot;minLength&quot;:</span> <span class="pre">6,</span> <span class="pre">&quot;maxLength&quot;:</span> <span class="pre">8,</span> <span class="pre">&quot;format&quot;:</span> <span class="pre">&quot;\d{6,8}&quot;,</span> <span class="pre">&quot;x-datetime&quot;:</span> <span class="pre">[&quot;%Y%m%d&quot;,</span> <span class="pre">&quot;%y%m%d&quot;]}</span></code></p>
</dd>
</dl>
<p>Where the <code class="docutils literal notranslate"><span class="pre">x-datetime</span></code> field is an extension to provide the conversion format for <code class="xref py py-func docutils literal notranslate"><span class="pre">datetime.datetime.strptime()</span></code></p>
<p>The Code definitions, similarly, are part of the module of schema details.
These are incorporated explicitly into the JSON Schema.</p>
<p>In JSON Schema, a “$ref” path of the form “#/$common/some_code” or “#/$common/some_element_schema”,
provides a reference to the reusable data element definitions.
This parallels the Python <code class="docutils literal notranslate"><span class="pre">x12.common</span></code> module which has these definitions.</p>
<p>Using “#” implies  the “$common” section is part of each message’s overall JSONSchema definition.
It could be replaced with an external reference using a full URI, which might be more
sensible in the long run.</p>
<section id="type-names-and-stuctures">
<h5>Type Names and Stuctures<a class="headerlink" href="#type-names-and-stuctures" title="Permalink to this heading">¶</a></h5>
<p>There are two pools of type definitions in <code class="docutils literal notranslate"><span class="pre">dataele.xml</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Ixx</span></code> names, part of the reused ISA segment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nnn</span></code> numbers, used everywhere else. We rename these to <code class="docutils literal notranslate"><span class="pre">D_nnn</span></code> to provide a Pythonic name.</p></li>
</ul>
<p>There are two pools of code definitions:</p>
<ul class="simple">
<li><p>Common codesets defined in the <code class="docutils literal notranslate"><span class="pre">codes.xml</span></code>.  (There are 9 of these.)</p></li>
<li><p>Data-element specific codesets defined within the element of a message.</p></li>
</ul>
<p>A data type, then, has the following definition aspects:</p>
<ul class="simple">
<li><p>Base <code class="docutils literal notranslate"><span class="pre">data_type_code</span></code> (“AN”, “ID”, “DT”, “TM”, etc.)
These are – generally – mappings to a Python type.
For the <code class="docutils literal notranslate"><span class="pre">Nx</span></code>, it includes the decimal scale factor.
For <code class="docutils literal notranslate"><span class="pre">DT</span></code> and <code class="docutils literal notranslate"><span class="pre">TM</span></code>, the length is required, also.</p></li>
<li><p>Annotations with common definition details (minLength, maxLength, title) from <code class="docutils literal notranslate"><span class="pre">common.xml</span></code>.
A “format” value is implied by the length for <code class="docutils literal notranslate"><span class="pre">DT</span></code>, <code class="docutils literal notranslate"><span class="pre">TM</span></code>, <code class="docutils literal notranslate"><span class="pre">Nx</span></code>, <code class="docutils literal notranslate"><span class="pre">N</span></code>, and <code class="docutils literal notranslate"><span class="pre">R</span></code>.</p></li>
<li><p>Enumerated literals come either from a <code class="docutils literal notranslate"><span class="pre">codes.xml</span></code> or from the element definition.</p></li>
</ul>
</section>
<section id="type-extensions">
<h5>Type Extensions<a class="headerlink" href="#type-extensions" title="Permalink to this heading">¶</a></h5>
<p>Some messages will have AN fields with a type and a value.
This extra type detail is one of the following:</p>
<ul class="simple">
<li><p>D8 (yyyymmdd),</p></li>
<li><p>D6 (yymmdd),</p></li>
<li><p>RD8 (yyyymmdd-yyyymmdd),</p></li>
<li><p>TM (hhmm)</p></li>
</ul>
<p>These are types <strong>outside</strong> the X12 definitions.
They’re application-specific, and depend on
two adjacent fields to work.</p>
</section>
</section>
<section id="schema-and-annotations">
<h4>Schema and Annotations<a class="headerlink" href="#schema-and-annotations" title="Permalink to this heading">¶</a></h4>
<p>There are two approaches to defining the type details.</p>
<ul class="simple">
<li><p>JSON Schema structures. This is called the “interim” solution.
It leverages an explicit class for each Element to carry
the schema details.</p></li>
<li><p>Type Annotations. This is the goal.
All of the schema information is carried
through Annotations.</p></li>
</ul>
<p>The transition is tricky because
the <code class="docutils literal notranslate"><span class="pre">xml_extract</span></code> application must generate
both variants, making it rather complicated.</p>
</section>
<section id="x12-message-version-mapping">
<h4>X12 Message Version Mapping<a class="headerlink" href="#x12-message-version-mapping" title="Permalink to this heading">¶</a></h4>
<p>The base mapping superclass permits a subclass to provide a rule
for disambiguating messages.</p>
<p>A mapping search class uses the collection of mapping objects
to locate the module that can parse a message.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>This version identification is not implemented</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.AnnotatedPythonMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">AnnotatedPythonMaker</span></span><a class="headerlink" href="#tools.xml_extract.AnnotatedPythonMaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Make Python using Annotated definitions.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tools.xml_extract.AnnotatedPythonMaker.visitor_class">
<span class="sig-name descname"><span class="pre">visitor_class</span></span><a class="headerlink" href="#tools.xml_extract.AnnotatedPythonMaker.visitor_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#tools.xml_extract.EmitPython_Annotated" title="tools.xml_extract.EmitPython_Annotated"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmitPython_Annotated</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.Codeset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">Codeset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_ele</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.Codeset" title="Permalink to this definition">¶</a></dt>
<dd><p>An enumerated set of values used to define an Element.</p>
<p>A JSONSchema <code class="docutils literal notranslate"><span class="pre">{&quot;type&quot;:</span> <span class="pre">&quot;string&quot;,</span> <span class="pre">&quot;enum&quot;:</span> <span class="pre">[]}</span></code> schema.</p>
<p>No Annotation, these are <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">[values]</span></code> constructs in Python.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.Composite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">Composite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_ele</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refdes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syntax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tools.xml_extract.Element" title="tools.xml_extract.Element"><span class="pre">tools.xml_extract.Element</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.Composite" title="Permalink to this definition">¶</a></dt>
<dd><p>Composite of multiple Elements; an inline segment-like collection of Elements.</p>
<p>A JSONSchema {“type”: “object”: “properties”: {…}} schema</p>
<p>From a JSONSchema perspective, a composite isn’t flattened into a sequence
of attributes of the containing Segment.
The composite is described as if it’s a sub-segment.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.DataElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">DataElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ele_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.DataElement" title="Permalink to this definition">¶</a></dt>
<dd><p>A data element description, often reused by multiple Elements.</p>
<p>A JSONSchema {“type”: …, “minLength”: …, “maxLength”: …, “description”: …} schema</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.Element">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">Element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_ele</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refdes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_def</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic Element.</p>
<p>A JSONSchema property value: “name”: {“type”: …, etc.} piece of a Segment or Composite</p>
<p>Yes, codes are locally defined codes, where code_set is an imported set of codes.
They’re both the same JSONSchema enum attribute.</p>
<p>Usage=”R” (required) percolates up to the containing Composite or Segment.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tools.xml_extract.Element.annotation">
<span class="sig-name descname"><span class="pre">annotation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tools.xml_extract.Element.annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Some Segment or Composite will have</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">DT</span><span class="p">,</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Item&quot;</span><span class="p">),</span> <span class="n">Usage</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">),</span> <span class="n">Sequence</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">DT</span></code> type alias is <code class="docutils literal notranslate"><span class="pre">Annotated[datetime.date,</span> <span class="pre">...]</span></code>.</p>
<p>This flattens nicely to <code class="docutils literal notranslate"><span class="pre">datetime.date</span></code> with details.</p>
<p>Or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ItemName</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">DT</span><span class="p">,</span> <span class="n">title</span><span class="p">(</span><span class="s2">&quot;Item&quot;</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>
<span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ItemName</span><span class="p">],</span> <span class="n">MaxItems</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
<p>The list – as a whole – and the items both have annotations.
The over-all <code class="docutils literal notranslate"><span class="pre">list[]</span></code> has a <code class="docutils literal notranslate"><span class="pre">MaxItems()</span></code> annotation.
The Element within the list has the detailed annotations for this element.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.EmitPython_Annotated">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">EmitPython_Annotated</span></span><a class="headerlink" href="#tools.xml_extract.EmitPython_Annotated" title="Permalink to this definition">¶</a></dt>
<dd><p>Message visitor to emit Pythonic definitions for
Elements, Composites, Segments, Loops, and Messages.</p>
<p>This is “Annotated”. Elements don’t have a separate class,
their annotations are part of the containing Segment or Composite.</p>
<p>The classes created will be extension subclasses to definitions in <code class="docutils literal notranslate"><span class="pre">x12.base</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tools.xml_extract.EmitPython_Annotated.codesets">
<span class="sig-name descname"><span class="pre">codesets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.Codeset" title="tools.xml_extract.Codeset"><span class="pre">tools.xml_extract.Codeset</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#tools.xml_extract.EmitPython_Annotated.codesets" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter for codesets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tools.xml_extract.EmitPython_Annotated.data_elements">
<span class="sig-name descname"><span class="pre">data_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.DataElement" title="tools.xml_extract.DataElement"><span class="pre">tools.xml_extract.DataElement</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#tools.xml_extract.EmitPython_Annotated.data_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter for data elements.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.EmitPython_Interim">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">EmitPython_Interim</span></span><a class="headerlink" href="#tools.xml_extract.EmitPython_Interim" title="Permalink to this definition">¶</a></dt>
<dd><p>Message visitor to emit Pythonic definitions for
Elements, Composites, Segments, Loops, and Messages.</p>
<p>This is “Interim”, which uses an explicit <code class="docutils literal notranslate"><span class="pre">Schema</span></code>
internal class definition.</p>
<p>The classes written will be extension subclasses to definitions in <code class="docutils literal notranslate"><span class="pre">x12.base</span></code>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.InterimPythonMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">InterimPythonMaker</span></span><a class="headerlink" href="#tools.xml_extract.InterimPythonMaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Make Python using Schema constructs.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tools.xml_extract.InterimPythonMaker.visitor_class">
<span class="sig-name descname"><span class="pre">visitor_class</span></span><a class="headerlink" href="#tools.xml_extract.InterimPythonMaker.visitor_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#tools.xml_extract.EmitPython_Interim" title="tools.xml_extract.EmitPython_Interim"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmitPython_Interim</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.Loop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">Loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">children</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tools.xml_extract.Segment" title="tools.xml_extract.Segment"><span class="pre">tools.xml_extract.Segment</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.Loop" title="tools.xml_extract.Loop"><span class="pre">tools.xml_extract.Loop</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.Loop" title="Permalink to this definition">¶</a></dt>
<dd><p>A higher-level collection of Loops and Segments.</p>
<p>A JSONSchema {“type”: “object”: “properties”: {…}} schema</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.Message">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">Message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tools.xml_extract.Loop" title="tools.xml_extract.Loop"><span class="pre">tools.xml_extract.Loop</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.Message" title="Permalink to this definition">¶</a></dt>
<dd><p>A Complete Message.</p>
<p>No annotation for a message as a whole,
it’s a collection of Loops, wrapped
in a <code class="docutils literal notranslate"><span class="pre">class</span></code> statement.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tools.xml_extract.Message.jsonschema">
<span class="sig-name descname"><span class="pre">jsonschema</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></span><a class="headerlink" href="#tools.xml_extract.Message.jsonschema" title="Permalink to this definition">¶</a></dt>
<dd><p>Emits JSON Schema for a message.</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>properly flatten the message to emit $loop, $segment, $composite, and $element definitions.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.MessageVisitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">MessageVisitor</span></span><a class="headerlink" href="#tools.xml_extract.MessageVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract Visitor for all layers of a message, in Post-Order traversal.</p>
<p>This works UP the message structure from elements to composites, segments, loops,
and finally the containing message.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tools.xml_extract.MessageVisitor.codesets">
<span class="sig-name descname"><span class="pre">codesets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.Codeset" title="tools.xml_extract.Codeset"><span class="pre">tools.xml_extract.Codeset</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#tools.xml_extract.MessageVisitor.codesets" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter for codesets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tools.xml_extract.MessageVisitor.data_elements">
<span class="sig-name descname"><span class="pre">data_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.DataElement" title="tools.xml_extract.DataElement"><span class="pre">tools.xml_extract.DataElement</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#tools.xml_extract.MessageVisitor.data_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter for data elements.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.SchemaMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">SchemaMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">icvn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vriic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abbr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">definition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.SchemaMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Rules for mapping a given message to a specific versioned type.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tools.xml_extract.Segment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">Segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_use</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syntax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">children</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tools.xml_extract.Element" title="tools.xml_extract.Element"><span class="pre">tools.xml_extract.Element</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.Composite" title="tools.xml_extract.Composite"><span class="pre">tools.xml_extract.Composite</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tools.xml_extract.Segment" title="Permalink to this definition">¶</a></dt>
<dd><p>A collection of Elements and Composites.</p>
<p>A JSONSchema {“type”: “object”: “properties”: {…}} schema</p>
<dl class="py method">
<dt class="sig sig-object py" id="tools.xml_extract.Segment.annotation">
<span class="sig-name descname"><span class="pre">annotation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tools.xml_extract.Segment.annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Some Message or Loop will have</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Loop_Seg_Class</span><span class="p">,</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Segnment&quot;</span><span class="p">),</span> <span class="n">Usage</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">),</span> <span class="n">Sequence</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)]</span>
</pre></div>
</div>
<p>This flattens nicely to <code class="docutils literal notranslate"><span class="pre">Loop_Seg_Class</span></code> with details.</p>
<p>Or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ItemSegment</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Loop_Seg_Class</span><span class="p">,</span> <span class="n">title</span><span class="p">(</span><span class="s2">&quot;Segnment&quot;</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>
<span class="n">segment</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ItemSegment</span><span class="p">],</span> <span class="n">MaxItems</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
<p>The list – as a whole – and the items both have annotations.
List annotations are small (MaxItems).
The Segment in the list has more complex annotations.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.code_reader">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">code_reader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tools.xml_extract.Codeset" title="tools.xml_extract.Codeset"><span class="pre">Codeset</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tools.xml_extract.code_reader" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference external" href="https://github.com/azoner/pyx12/blob/master/pyx12/map/codes.rng">https://github.com/azoner/pyx12/blob/master/pyx12/map/codes.rng</a></p>
<p>The RelaxNG schema doesn’t exactly match the XML.</p>
<p>The schema is approximately this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">schema</span><span class="p">:</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">codesets</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">array</span>
    <span class="n">items</span><span class="p">:</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">codeset</span>
        <span class="nb">type</span><span class="p">:</span> <span class="nb">object</span>
        <span class="n">properties</span><span class="p">:</span>
            <span class="nb">id</span><span class="p">:</span>
                <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
                <span class="n">maxLength</span><span class="p">:</span> <span class="mi">20</span>
            <span class="n">name</span><span class="p">:</span>
                <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
                <span class="n">maxLength</span><span class="p">:</span> <span class="mi">100</span>
            <span class="n">data_ele</span><span class="p">:</span>
                <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
                <span class="n">maxLength</span><span class="p">:</span> <span class="mi">6</span>
            <span class="n">source</span><span class="p">:</span>
                <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
            <span class="n">version</span><span class="p">:</span>
                <span class="nb">type</span><span class="p">:</span> <span class="n">array</span>
                <span class="n">items</span><span class="p">:</span>
                    <span class="n">description</span><span class="p">:</span> <span class="n">version</span>
                    <span class="nb">type</span><span class="p">:</span> <span class="nb">object</span>
                    <span class="n">properties</span><span class="p">:</span>
                        <span class="nb">id</span><span class="p">:</span>
                            <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
                            <span class="n">maxLength</span><span class="p">:</span> <span class="mi">20</span>
                        <span class="n">eff_dte</span><span class="p">:</span>
                            <span class="nb">type</span><span class="p">:</span> <span class="n">stringh</span>
                        <span class="n">code</span><span class="p">:</span>
                            <span class="nb">type</span><span class="p">:</span> <span class="n">array</span>
                            <span class="n">items</span><span class="p">:</span>
                                <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
                                <span class="n">maxLength</span><span class="p">:</span> <span class="mi">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.element_reader">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">element_reader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tools.xml_extract.DataElement" title="tools.xml_extract.DataElement"><span class="pre">DataElement</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tools.xml_extract.element_reader" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference external" href="https://github.com/azoner/pyx12/blob/master/pyx12/map/codes.rng">https://github.com/azoner/pyx12/blob/master/pyx12/map/codes.rng</a></p>
<p>The RelaxNG schema seems to match the XML.
Note that the schema is all attributes, not actual tags.</p>
<p>The schema is approximately this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">description</span><span class="p">:</span> <span class="n">data_elements</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">array</span>
<span class="n">items</span><span class="p">:</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">data_ele</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">object</span>
    <span class="n">properties</span><span class="p">:</span>
        <span class="n">ele_num</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
            <span class="nb">max</span><span class="o">-</span><span class="n">length</span><span class="p">:</span> <span class="mi">4</span>
        <span class="n">data_type</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
            <span class="n">enum</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;AN&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;DT&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;TM&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;N0&quot;</span><span class="p">,</span> <span class="s2">&quot;N1&quot;</span><span class="p">,</span> <span class="s2">&quot;N2&quot;</span><span class="p">,</span>  <span class="s2">&quot;N3&quot;</span><span class="p">,</span> <span class="s2">&quot;N4&quot;</span><span class="p">,</span> <span class="s2">&quot;N5&quot;</span><span class="p">,</span>  <span class="s2">&quot;N6&quot;</span><span class="p">,</span> <span class="s2">&quot;N7&quot;</span><span class="p">,</span> <span class="s2">&quot;N8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;N9&quot;</span><span class="p">]</span>
        <span class="n">min_len</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">:</span> <span class="n">number</span>
            <span class="n">maximum</span><span class="p">:</span> <span class="mi">16384</span>
        <span class="n">max_len</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">:</span> <span class="n">number</span>
            <span class="n">maximum</span><span class="p">:</span> <span class="mi">16384</span>
        <span class="n">name</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.make_jsonschema">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">make_jsonschema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#tools.xml_extract.make_jsonschema" title="Permalink to this definition">¶</a></dt>
<dd><p>Making JSON Schema is possible.
JSON Schema <strong>should</strong> be created from the Python, not directly from the XML.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.make_message_schema">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">make_message_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codesets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.Codeset" title="tools.xml_extract.Codeset"><span class="pre">tools.xml_extract.Codeset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tools.xml_extract.DataElement" title="tools.xml_extract.DataElement"><span class="pre">tools.xml_extract.DataElement</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_package</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#tools.xml_extract.make_message_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit JSON Schema for a message.</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Include the “$ref” data types and code sets.</p>
</div>
<p>JSON Schema <strong>should</strong> be created from the Python, not from the XML.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.make_python">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">make_python</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PythonMaker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x12_package</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#tools.xml_extract.make_python" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract from XML schema and make Python modules for parsing messages.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.make_schema">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">make_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#tools.xml_extract.make_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract from XML schema, creating JSON Schema.</p>
<p>Each message becomes a separate .json document.</p>
<p>JSON Schema <strong>should</strong> be created from the Python, not from the XML.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.map_reader">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">map_reader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tools.xml_extract.SchemaMap" title="tools.xml_extract.SchemaMap"><span class="pre">SchemaMap</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tools.xml_extract.map_reader" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping of document to schema version.</p>
<p>See <a class="reference external" href="https://github.com/azoner/pyx12/blob/master/pyx12/map/maps.xsd">https://github.com/azoner/pyx12/blob/master/pyx12/map/maps.xsd</a></p>
<p>Attributes used to distinguish the document schema</p>
<ul class="simple">
<li><p>icvn - Interchange Control Version Number (ISA12)</p></li>
<li><p>fic - Functional Identifier Code (GS01)</p></li>
<li><p>vriic - Version / Release / Industry Identifier Code (GS08)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tools.xml_extract.message_reader">
<span class="sig-prename descclassname"><span class="pre">tools.xml_extract.</span></span><span class="sig-name descname"><span class="pre">message_reader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tools.xml_extract.Message" title="tools.xml_extract.Message"><span class="pre">Message</span></a></span></span><a class="headerlink" href="#tools.xml_extract.message_reader" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference external" href="https://github.com/azoner/pyx12/blob/master/pyx12/map/map.xsd">https://github.com/azoner/pyx12/blob/master/pyx12/map/map.xsd</a></p>
<p>Note that the common (control) messages use a lot of named elements.
The other messages use a lot of attributes.
Hence the duplication.</p>
<p>The summary of the schema is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transaction</span> <span class="p">(</span><span class="n">xid</span><span class="p">)</span>
    <span class="n">name</span>
    <span class="n">loop</span>

<span class="n">loop</span> <span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
    <span class="n">name</span>
    <span class="n">usage</span>
    <span class="n">pos</span>
    <span class="n">repeat</span>
    <span class="n">segment</span> <span class="o">|</span> <span class="n">loop</span>

<span class="n">segment</span> <span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">max_use</span><span class="p">)</span>
    <span class="n">name</span>
    <span class="n">end_tag</span>
    <span class="n">usage</span>
    <span class="n">pos</span>
    <span class="n">max_use</span>
    <span class="n">syntax</span>
    <span class="n">element</span> <span class="o">|</span> <span class="n">composite</span>

<span class="n">composite</span> <span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">data_ele</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span>
    <span class="n">data_ele</span>
    <span class="n">name</span>
    <span class="n">usage</span>
    <span class="n">seq</span>
    <span class="n">refdes</span>
    <span class="n">syntax</span>
    <span class="n">repeat</span>
    <span class="n">element</span>

<span class="n">element</span> <span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">data_ele</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span>
    <span class="n">data_ele</span>
    <span class="n">name</span>
    <span class="n">usage</span>
    <span class="n">seq</span>
    <span class="n">refdes</span>
    <span class="n">repeat</span>
    <span class="n">valid_codes</span> <span class="p">(</span><span class="n">external</span><span class="p">)</span>
        <span class="n">code</span>
</pre></div>
</div>
<p>usage: one of R (required), S (situational), N (not used)</p>
<p>syntax: uses a string with the following structure <code class="docutils literal notranslate"><span class="pre">(E|L|P|C|R)([0-9]{2}){2,20}</span></code></p>
<blockquote>
<div><p>E - Exclusion - Not more than one specified element may be present</p>
<p>L - List - If first is present, at least one other must be present</p>
<p>P - Paired or Multiple - If any element specified is present, all must be present</p>
<p>C - Conditional - If first is present, all others must be present</p>
<p>R - Required - At least one must be present</p>
<p>Followed by two-digit numbers to list elements to which this syntax applies.</p>
</div></blockquote>
</dd></dl>

</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Tiger_shark2.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">TigerShark</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../operation.html">Using TigerShark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usecase.html">Context: Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture and Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/index.html">Design Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Implementation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="x12.html"><code class="docutils literal notranslate"><span class="pre">X12</span></code> Package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">tools</span></code> Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">The TODO List</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Implementation</a><ul>
      <li>Previous: <a href="x12.html" title="previous chapter"><code class="docutils literal notranslate"><span class="pre">X12</span></code> Package</a></li>
      <li>Next: <a href="../todo.html" title="next chapter">The TODO List</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, S.Lott.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/implementation/tools.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>